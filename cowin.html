<!DOCTYPE html>
<html>
   <head>
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
      <script>
         function beep() {
          var snd = new Audio("data:audio/wav;base64,//uQRAAAAWMSLwUIYAAsYkXgoQwAEaYLWfkWgAI0wWs/ItAAAGDgYtAgAyN+QWaAAihwMWm4G8QQRDiMcCBcH3Cc+CDv/7xA4Tvh9Rz/y8QADBwMWgQAZG/ILNAARQ4GLTcDeIIIhxGOBAuD7hOfBB3/94gcJ3w+o5/5eIAIAAAVwWgQAVQ2ORaIQwEMAJiDg95G4nQL7mQVWI6GwRcfsZAcsKkJvxgxEjzFUgfHoSQ9Qq7KNwqHwuB13MA4a1q/DmBrHgPcmjiGoh//EwC5nGPEmS4RcfkVKOhJf+WOgoxJclFz3kgn//dBA+ya1GhurNn8zb//9NNutNuhz31f////9vt///z+IdAEAAAK4LQIAKobHItEIYCGAExBwe8jcToF9zIKrEdDYIuP2MgOWFSE34wYiR5iqQPj0JIeoVdlG4VD4XA67mAcNa1fhzA1jwHuTRxDUQ//iYBczjHiTJcIuPyKlHQkv/LHQUYkuSi57yQT//uggfZNajQ3Vmz+Zt//+mm3Wm3Q576v////+32///5/EOgAAADVghQAAAAA//uQZAUAB1WI0PZugAAAAAoQwAAAEk3nRd2qAAAAACiDgAAAAAAABCqEEQRLCgwpBGMlJkIz8jKhGvj4k6jzRnqasNKIeoh5gI7BJaC1A1AoNBjJgbyApVS4IDlZgDU5WUAxEKDNmmALHzZp0Fkz1FMTmGFl1FMEyodIavcCAUHDWrKAIA4aa2oCgILEBupZgHvAhEBcZ6joQBxS76AgccrFlczBvKLC0QI2cBoCFvfTDAo7eoOQInqDPBtvrDEZBNYN5xwNwxQRfw8ZQ5wQVLvO8OYU+mHvFLlDh05Mdg7BT6YrRPpCBznMB2r//xKJjyyOh+cImr2/4doscwD6neZjuZR4AgAABYAAAABy1xcdQtxYBYYZdifkUDgzzXaXn98Z0oi9ILU5mBjFANmRwlVJ3/6jYDAmxaiDG3/6xjQQCCKkRb/6kg/wW+kSJ5//rLobkLSiKmqP/0ikJuDaSaSf/6JiLYLEYnW/+kXg1WRVJL/9EmQ1YZIsv/6Qzwy5qk7/+tEU0nkls3/zIUMPKNX/6yZLf+kFgAfgGyLFAUwY//uQZAUABcd5UiNPVXAAAApAAAAAE0VZQKw9ISAAACgAAAAAVQIygIElVrFkBS+Jhi+EAuu+lKAkYUEIsmEAEoMeDmCETMvfSHTGkF5RWH7kz/ESHWPAq/kcCRhqBtMdokPdM7vil7RG98A2sc7zO6ZvTdM7pmOUAZTnJW+NXxqmd41dqJ6mLTXxrPpnV8avaIf5SvL7pndPvPpndJR9Kuu8fePvuiuhorgWjp7Mf/PRjxcFCPDkW31srioCExivv9lcwKEaHsf/7ow2Fl1T/9RkXgEhYElAoCLFtMArxwivDJJ+bR1HTKJdlEoTELCIqgEwVGSQ+hIm0NbK8WXcTEI0UPoa2NbG4y2K00JEWbZavJXkYaqo9CRHS55FcZTjKEk3NKoCYUnSQ0rWxrZbFKbKIhOKPZe1cJKzZSaQrIyULHDZmV5K4xySsDRKWOruanGtjLJXFEmwaIbDLX0hIPBUQPVFVkQkDoUNfSoDgQGKPekoxeGzA4DUvnn4bxzcZrtJyipKfPNy5w+9lnXwgqsiyHNeSVpemw4bWb9psYeq//uQZBoABQt4yMVxYAIAAAkQoAAAHvYpL5m6AAgAACXDAAAAD59jblTirQe9upFsmZbpMudy7Lz1X1DYsxOOSWpfPqNX2WqktK0DMvuGwlbNj44TleLPQ+Gsfb+GOWOKJoIrWb3cIMeeON6lz2umTqMXV8Mj30yWPpjoSa9ujK8SyeJP5y5mOW1D6hvLepeveEAEDo0mgCRClOEgANv3B9a6fikgUSu/DmAMATrGx7nng5p5iimPNZsfQLYB2sDLIkzRKZOHGAaUyDcpFBSLG9MCQALgAIgQs2YunOszLSAyQYPVC2YdGGeHD2dTdJk1pAHGAWDjnkcLKFymS3RQZTInzySoBwMG0QueC3gMsCEYxUqlrcxK6k1LQQcsmyYeQPdC2YfuGPASCBkcVMQQqpVJshui1tkXQJQV0OXGAZMXSOEEBRirXbVRQW7ugq7IM7rPWSZyDlM3IuNEkxzCOJ0ny2ThNkyRai1b6ev//3dzNGzNb//4uAvHT5sURcZCFcuKLhOFs8mLAAEAt4UWAAIABAAAAAB4qbHo0tIjVkUU//uQZAwABfSFz3ZqQAAAAAngwAAAE1HjMp2qAAAAACZDgAAAD5UkTE1UgZEUExqYynN1qZvqIOREEFmBcJQkwdxiFtw0qEOkGYfRDifBui9MQg4QAHAqWtAWHoCxu1Yf4VfWLPIM2mHDFsbQEVGwyqQoQcwnfHeIkNt9YnkiaS1oizycqJrx4KOQjahZxWbcZgztj2c49nKmkId44S71j0c8eV9yDK6uPRzx5X18eDvjvQ6yKo9ZSS6l//8elePK/Lf//IInrOF/FvDoADYAGBMGb7FtErm5MXMlmPAJQVgWta7Zx2go+8xJ0UiCb8LHHdftWyLJE0QIAIsI+UbXu67dZMjmgDGCGl1H+vpF4NSDckSIkk7Vd+sxEhBQMRU8j/12UIRhzSaUdQ+rQU5kGeFxm+hb1oh6pWWmv3uvmReDl0UnvtapVaIzo1jZbf/pD6ElLqSX+rUmOQNpJFa/r+sa4e/pBlAABoAAAAA3CUgShLdGIxsY7AUABPRrgCABdDuQ5GC7DqPQCgbbJUAoRSUj+NIEig0YfyWUho1VBBBA//uQZB4ABZx5zfMakeAAAAmwAAAAF5F3P0w9GtAAACfAAAAAwLhMDmAYWMgVEG1U0FIGCBgXBXAtfMH10000EEEEEECUBYln03TTTdNBDZopopYvrTTdNa325mImNg3TTPV9q3pmY0xoO6bv3r00y+IDGid/9aaaZTGMuj9mpu9Mpio1dXrr5HERTZSmqU36A3CumzN/9Robv/Xx4v9ijkSRSNLQhAWumap82WRSBUqXStV/YcS+XVLnSS+WLDroqArFkMEsAS+eWmrUzrO0oEmE40RlMZ5+ODIkAyKAGUwZ3mVKmcamcJnMW26MRPgUw6j+LkhyHGVGYjSUUKNpuJUQoOIAyDvEyG8S5yfK6dhZc0Tx1KI/gviKL6qvvFs1+bWtaz58uUNnryq6kt5RzOCkPWlVqVX2a/EEBUdU1KrXLf40GoiiFXK///qpoiDXrOgqDR38JB0bw7SoL+ZB9o1RCkQjQ2CBYZKd/+VJxZRRZlqSkKiws0WFxUyCwsKiMy7hUVFhIaCrNQsKkTIsLivwKKigsj8XYlwt/WKi2N4d//uQRCSAAjURNIHpMZBGYiaQPSYyAAABLAAAAAAAACWAAAAApUF/Mg+0aohSIRobBAsMlO//Kk4soosy1JSFRYWaLC4qZBYWFRGZdwqKiwkNBVmoWFSJkWFxX4FFRQWR+LsS4W/rFRb/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////VEFHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAU291bmRib3kuZGUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMjAwNGh0dHA6Ly93d3cuc291bmRib3kuZGUAAAAAAAAAACU=");  
          snd.play();
         }
         
               //var bookData = data;
         // {"district_id":363,"district_name":"Pune"}
         // {"districts":[{"district_id":391,"district_name":"Ahmednagar"},{"district_id":364,"district_name":"Akola"},{"district_id":366,"district_name":"Amravati"},{"district_id":397,"district_name":"Aurangabad "},{"district_id":384,"district_name":"Beed"},{"district_id":370,"district_name":"Bhandara"},{"district_id":367,"district_name":"Buldhana"},{"district_id":380,"district_name":"Chandrapur"},{"district_id":388,"district_name":"Dhule"},{"district_id":379,"district_name":"Gadchiroli"},{"district_id":378,"district_name":"Gondia"},{"district_id":386,"district_name":"Hingoli"},{"district_id":390,"district_name":"Jalgaon"},{"district_id":396,"district_name":"Jalna"},{"district_id":371,"district_name":"Kolhapur"},{"district_id":383,"district_name":"Latur"},{"district_id":395,"district_name":"Mumbai"},{"district_id":365,"district_name":"Nagpur"},{"district_id":382,"district_name":"Nanded"},{"district_id":387,"district_name":"Nandurbar"},{"district_id":389,"district_name":"Nashik"},{"district_id":381,"district_name":"Osmanabad"},{"district_id":394,"district_name":"Palghar"},{"district_id":385,"district_name":"Parbhani"},{"district_id":363,"district_name":"Pune"},{"district_id":393,"district_name":"Raigad"},{"district_id":372,"district_name":"Ratnagiri"},{"district_id":373,"district_name":"Sangli"},{"district_id":376,"district_name":"Satara"},{"district_id":374,"district_name":"Sindhudurg"},{"district_id":375,"district_name":"Solapur"},{"district_id":392,"district_name":"Thane"},{"district_id":377,"district_name":"Wardha"},{"district_id":369,"district_name":"Washim"},{"district_id":368,"district_name":"Yavatmal"}],"ttl":24}
         // gorakhpur 654
      $(document).ready(function(){
           $("#buttonId").click(function(){  
					   pollDOM();
					$("button").text("STARTED");
				 });
               	var availPinCodeArr = [];
                 var urlDist = "https://cdn-api.co-vin.in/api/v2/appointment/sessions/public/calendarByDistrict?district_id=654&date=11-05-2021";
                 var urlPinCode = "https://cdn-api.co-vin.in/api/v2/appointment/sessions/public/calendarByPin?pincode=273008&date=11-05-2021";
                var waitTimeInSeconds = 6;
               var count = 0;
         var tick = 0;
               function pollDOM () {
               $("#tickId").text("Time :" + new Date());
               	checkAval();
               				
                   setTimeout(pollDOM, waitTimeInSeconds* 1000); // try again in 300 milliseconds
               }
                function checkAval(){
               	 tick++;						
               	$("#countId").text("Tick : "+ tick + ",  Slot Found : " + count);
                   $.get(urlDist, function(data, status){
                //     console.log(data);
               	  jQuery.each(data.centers, function(index, jsonValue){ 
               //		console.log(jsonValue.sessions);
               		jQuery.each(jsonValue.sessions , function(inde, sess){
               	//		console.log(sess.available_capacity);
               			if(sess.available_capacity > 0 && jQuery.inArray(jsonValue.pincode, availPinCodeArr) == -1){
         			       beep();
               				count++;
               				availPinCodeArr.push(jsonValue.pincode);
               				var addrEl = $("<p></p>").text("address :" + jsonValue.address +" "+ jsonValue.pincode);
               				var dateEl = $("<p></p>").text("Date :" + sess.date);
               				var countEl = $("<p></p>").text("Available :" + sess.available_capacity + "    [age: " + sess.min_age_limit + "+]");
               				var timeEl = $("<p></p>").text("Slot Open Time :" + new Date());
               				var seperEl = $("<hr >");
               				$("#avalDivId").append(addrEl, dateEl, countEl, timeEl, seperEl);     
               				beep();   						
               			}
               		});
               	  });
                //      $("#target").text(  JSON.stringify(data));
               	  //   alert("Data: " + JSON.stringify(data) + "\nStatus: " + status);
                   });
                 }
               });
            
      </script>
   </head>
   <body>
      <button id="buttonId"> Start </button>
      <h4 id="countId">
      </h2>
      <h4 id="tickId"></h4>
      <br/>
      <div id = "avalDivId">
         <br/>
      </div>
      <br/>
      <br/>
      <div id="target"></div>
   </body>
</html>
<!-- 
   {
   	"centers": [
   		{
   			"center_id": 692559,
   			"name": "AIIMS AYOUSH 18 TO 44 YEAR",
   			"address": "AIIMS AYOUSH BUILDING GORAKHPUR",
   			"state_name": "Uttar Pradesh",
   			"district_name": "Gorakhpur",
   			"block_name": "Gorakhpur Sadar",
   			"pincode": 273008,
   			"lat": 26,
   			"long": 83,
   			"from": "10:00:00",
   			"to": "16:00:00",
   			"fee_type": "Free",
   			"sessions": [
   				{
   					"session_id": "dbd0a069-ba59-4f67-a457-f14ef8384fe7",
   					"date": "11-05-2021",
   					"available_capacity": 0,
   					"min_age_limit": 18,
   					"vaccine": "COVISHIELD",
   					"slots": [
   						"10:00AM-11:00AM",
   						"11:00AM-12:00PM",
   						"12:00PM-01:00PM",
   						"01:00PM-04:00PM"
   					]
   				},
   				{
   					"session_id": "32750ad2-db28-41e1-895d-fc46f4c09201",
   					"date": "12-05-2021",
   					"available_capacity": 0,
   					"min_age_limit": 18,
   					"vaccine": "COVISHIELD",
   					"slots": [
   						"10:00AM-11:00AM",
   						"11:00AM-12:00PM",
   						"12:00PM-01:00PM",
   						"01:00PM-04:00PM"
   					]
   				},
   				{
   					"session_id": "b6e5f43b-70fe-42aa-9c93-025f960db318",
   					"date": "13-05-2021",
   					"available_capacity": 0,
   					"min_age_limit": 18,
   					"vaccine": "COVISHIELD",
   					"slots": [
   						"10:00AM-11:00AM",
   						"11:00AM-12:00PM",
   						"12:00PM-01:00PM",
   						"01:00PM-04:00PM"
   					]
   				},
   				{
   					"session_id": "d8223143-dc0b-4ea0-9b6f-84795dcf1248",
   					"date": "14-05-2021",
   					"available_capacity": 0,
   					"min_age_limit": 18,
   					"vaccine": "COVISHIELD",
   					"slots": [
   						"10:00AM-11:00AM",
   						"11:00AM-12:00PM",
   						"12:00PM-01:00PM",
   						"01:00PM-04:00PM"
   					]
   				},
   				{
   					"session_id": "dc3bb0b5-377b-4019-97fb-cd27843a6bbe",
   					"date": "15-05-2021",
   					"available_capacity": 0,
   					"min_age_limit": 18,
   					"vaccine": "COVISHIELD",
   					"slots": [
   						"10:00AM-11:00AM",
   						"11:00AM-12:00PM",
   						"12:00PM-01:00PM",
   						"01:00PM-04:00PM"
   					]
   				}
   			]
   		}
   	]
   }
   -->